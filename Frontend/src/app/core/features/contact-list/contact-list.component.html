<div class="container">
  <div class="level">
    <div class="level-left">
      <h2 class="title is-3 mb-5">Contactos de la comunidad</h2>
    </div>
    <div class="level-right">
      <button class="button" (click)="openAddModal()">
        <span class="icon mr-1">
          <i class="fa-solid fa-plus"></i>
        </span>
        Agregar Contacto
      </button>
    </div>
  </div>
</div>

@if (isLoading) {
<div class="container">
  <div class="skeleton-lines">
    <div></div>
    <div></div>
    <div></div>
    <div></div>
  </div>
</div>
} @else {
<div class="container mt-4">
  <!-- Search Box -->
  <div class="box">
    <div class="field">
      <label class="label">Buscar contacto</label>
      <div class="control">
        <input
          class="input"
          type="text"
          [(ngModel)]="searchTerm"
          (input)="filterContacts()"
          placeholder="Búsqueda por nombre, teléfono o servicio"
        />
      </div>
    </div>
  </div>

  <!-- Contact List -->
  <div class="box">
    <div class="table-container">
      <table class="table is-fullwidth">
        <thead>
          <tr>
            <th>#</th>
            <th>Nombre</th>
            <th>Correo</th>
            <th>Teléfono</th>
            <th>Servicio</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          @if (!contactos || contactos.length === 0){
          <td colspan="5">No hay contactos disponibles</td>
          } @else { @for (contacto of filteredContacts; track contacto.id; let
          idx = $index, e = $even){
          <tr>
            <td>{{ idx + 1 }}</td>
            <td>{{ contacto.firstName + " " + contacto.lastName }}</td>
            <td>{{ contacto.email }}</td>
            <td>{{ contacto.phoneNumber }}</td>
            <td>{{ contacto.service }}</td>
            <td>
              <button class="button" (click)="openEditModal(contacto)">
                <span class="icon mr-1">
                  <i class="fas fa-pencil-alt"></i>
                </span>
                Editar
              </button>
            </td>
          </tr>
          } }
        </tbody>
      </table>
    </div>
  </div>
</div>
} @if(isModalOpen){
<app-add-contact [CommunityID]="this.CommunityID" (close)="onClickCloseAdd()">
</app-add-contact>
} @if(isEditModalOpen){
<app-edit-contact
  [ContactEdited]="this.contactToEdit"
  (close)="onClickCloseEdit()"
></app-edit-contact>
}
